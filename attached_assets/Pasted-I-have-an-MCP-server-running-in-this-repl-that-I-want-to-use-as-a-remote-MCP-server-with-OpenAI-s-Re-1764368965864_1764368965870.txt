I have an MCP server running in this repl that I want to use as a remote MCP server with OpenAI’s Responses API and Agent Builder.

Right now:

The app exposes a /health endpoint that returns JSON like { status: "ok", version: "3.1.0", activeConnections, ... }.

It also exposes an MCP endpoint via SSE at /sse.

When I point MCP Inspector or Agent Builder at https://zoner-mcp.replit.app/sse, I either get connection errors or “this server does not expose any tools.”

I need you to refactor the server to use Streamable HTTP instead of SSE, while preserving all existing tools and behavior.

What I want you to do

Detect the tech stack and SDK

Look at the current code and identify whether this is Node/TypeScript (likely using @modelcontextprotocol/sdk/server) or Python (using the MCP Python SDK).

Work within the existing stack; do not rewrite the project in a different language.

Keep /health exactly as it is

Do not change the /health route or its response shape.

This is my monitoring endpoint and is already working.

Replace the SSE MCP endpoint with a Streamable HTTP endpoint

Stop using the SSE transport at /sse for MCP. You can delete or ignore that route.

Implement a Streamable HTTP MCP endpoint at:

POST /mcp

For Node/TS:

Use StreamableHTTPServerTransport from @modelcontextprotocol/sdk/server.

Wire it so that POST /mcp creates a StreamableHTTPServerTransport from the incoming req/res and calls mcpServer.connect(transport).

For Python:

Use the equivalent Streamable HTTP transport from the MCP Python SDK and expose it at POST /mcp (FastAPI/Starlette/Flask, depending on what is already in use).

Preserve and verify existing MCP tools

There is at least one tool that does a zoning district lookup by address. Keep all of those tool definitions exactly the same.

Make sure they are registered on the same MCP Server instance that you connect to via StreamableHTTPServerTransport.

Double-check that tools/list returns at least one tool (e.g., district_lookup) with a proper JSON schema input (object with address: string).

Server startup

Continue to listen on process.env.PORT || 3000 (or the existing pattern) so the Replit URL https://zoner-mcp.replit.app keeps working.

Do not introduce breaking changes to the way the repl is started.

Compatibility goals

After your changes, the server should work as a remote MCP server with this configuration:

MCP Inspector:

Transport Type: Streamable HTTP

URL: https://zoner-mcp.replit.app/mcp

Connection Type: Via Proxy

No auth

Agent Builder / Responses API:

server_url: https://zoner-mcp.replit.app/mcp

type: "mcp", server_label whatever, require_approval as needed.

When I connect with MCP Inspector using Streamable HTTP to /mcp, the Tools tab should show the zoning lookup tool(s) instead of “no tools.”

Clean, minimal changes

Make the smallest set of changes necessary to:

Remove reliance on SSE for MCP, and

Add a working Streamable HTTP /mcp endpoint.

Keep code organized and readable; add brief comments where appropriate.

When you’re done, summarize what you changed (files, routes, and how to run/test), and explicitly confirm that:

/health still works.

POST /mcp is the Streamable HTTP MCP endpoint.

Tools list correctly in MCP Inspector when pointed at https://zoner-mcp.replit.app/mcp.